/*
 * SimpleModal 1.3.5 - jQuery Plugin
 * http://www.ericmmartin.com/projects/simplemodal/
 * Copyright (c) 2010 Eric Martin (http://twitter.com/EricMMartin)
 * Dual licensed under the MIT and GPL licenses
 * Revision: $Id: jquery.simplemodal.js 245 2010-03-25 20:41:15Z emartin24 $
 */(function(a){var b=a.browser.msie&&parseInt(a.browser.version)==6&&typeof window["XMLHttpRequest"]!="object",c=null,d=[];a.modal=function(b,c){return a.modal.impl.init(b,c)};a.modal.close=function(){a.modal.impl.close()};a.fn.modal=function(b){return a.modal.impl.init(this,b)};a.modal.defaults={appendTo:"body",focus:!0,opacity:50,overlayId:"simplemodal-overlay",overlayCss:{},containerId:"simplemodal-container",containerCss:{},dataId:"simplemodal-data",dataCss:{},minHeight:null,minWidth:null,maxHeight:null,maxWidth:null,autoResize:!1,autoPosition:!0,zIndex:1e3,close:!0,closeHTML:'<a class="modalCloseImg" title="Close"></a>',closeClass:"simplemodal-close",escClose:!0,overlayClose:!1,position:null,persist:!1,modal:!0,onOpen:null,onShow:null,onClose:null};a.modal.impl={o:null,d:{},init:function(b,d){var e=this;if(e.d.data)return!1;c=a.browser.msie&&!a.boxModel;e.o=a.extend({},a.modal.defaults,d);e.zIndex=e.o.zIndex;e.occb=!1;if(typeof b=="object"){b=b instanceof jQuery?b:a(b);e.d.placeholder=!1;if(b.parent().parent().size()>0){b.before(a("<span></span>").attr("id","simplemodal-placeholder").css({display:"none"}));e.d.placeholder=!0;e.display=b.css("display");e.o.persist||(e.d.orig=b.clone(!0))}}else{if(typeof b!="string"&&typeof b!="number"){alert("SimpleModal Error: Unsupported data type: "+typeof b);return e}b=a("<div></div>").html(b)}e.create(b);b=null;e.open();a.isFunction(e.o.onShow)&&e.o.onShow.apply(e,[e.d]);return e},create:function(e){var f=this;d=f.getDimensions();f.o.modal&&b&&(f.d.iframe=a('<iframe src="javascript:false;"></iframe>').css(a.extend(f.o.iframeCss,{display:"none",opacity:0,position:"fixed",height:d[0],width:d[1],zIndex:f.o.zIndex,top:0,left:0})).appendTo(f.o.appendTo));f.d.overlay=a("<div></div>").attr("id",f.o.overlayId).addClass("simplemodal-overlay").css(a.extend(f.o.overlayCss,{display:"none",opacity:f.o.opacity/100,height:f.o.modal?d[0]:0,width:f.o.modal?d[1]:0,position:"fixed",left:0,top:0,zIndex:f.o.zIndex+1})).appendTo(f.o.appendTo);f.d.container=a("<div></div>").attr("id",f.o.containerId).addClass("simplemodal-container").css(a.extend(f.o.containerCss,{display:"none",position:"fixed",zIndex:f.o.zIndex+2})).append(f.o.close&&f.o.closeHTML?a(f.o.closeHTML).addClass(f.o.closeClass):"").appendTo(f.o.appendTo);f.d.wrap=a("<div></div>").attr("tabIndex",-1).addClass("simplemodal-wrap").css({height:"100%",outline:0,width:"100%"}).appendTo(f.d.container);f.d.data=e.attr("id",e.attr("id")||f.o.dataId).addClass("simplemodal-data").css(a.extend(f.o.dataCss,{display:"none"})).appendTo("body");e=null;f.setContainerDimensions();f.d.data.appendTo(f.d.wrap);(b||c)&&f.fixIE()},bindEvents:function(){var e=this;a("."+e.o.closeClass).bind("click.simplemodal",function(a){a.preventDefault();e.close()});e.o.modal&&e.o.close&&e.o.overlayClose&&e.d.overlay.bind("click.simplemodal",function(a){a.preventDefault();e.close()});a(document).bind("keydown.simplemodal",function(a){if(e.o.modal&&e.o.focus&&a.keyCode==9)e.watchTab(a);else if(e.o.close&&e.o.escClose&&a.keyCode==27){a.preventDefault();e.close()}});a(window).bind("resize.simplemodal",function(){d=e.getDimensions();e.setContainerDimensions(!0);if(b||c)e.fixIE();else if(e.o.modal){e.d.iframe&&e.d.iframe.css({height:d[0],width:d[1]});e.d.overlay.css({height:d[0],width:d[1]})}})},unbindEvents:function(){a("."+this.o.closeClass).unbind("click.simplemodal");a(document).unbind("keydown.simplemodal");a(window).unbind("resize.simplemodal");this.d.overlay.unbind("click.simplemodal")},fixIE:function(){var b=this,c=b.o.position;a.each([b.d.iframe||null,b.o.modal?b.d.overlay:null,b.d.container],function(a,b){if(b){var d="document.body.clientHeight",e="document.body.clientWidth",f="document.body.scrollHeight",g="document.body.scrollLeft",h="document.body.scrollTop",i="document.body.scrollWidth",j="document.documentElement.clientHeight",k="document.documentElement.clientWidth",l="document.documentElement.scrollLeft",m="document.documentElement.scrollTop",n=b[0].style;n.position="absolute";if(a<2){n.removeExpression("height");n.removeExpression("width");n.setExpression("height",""+f+" > "+d+" ? "+f+" : "+d+' + "px"');n.setExpression("width",""+i+" > "+e+" ? "+i+" : "+e+' + "px"')}else{var o,q;if(c&&c.constructor==Array){var r=c[0]?typeof c[0]=="number"?c[0].toString():c[0].replace(/px/,""):b.css("top").replace(/px/,"");o=r.indexOf("%")==-1?r+" + (t = "+m+" ? "+m+" : "+h+') + "px"':parseInt(r.replace(/%/,""))+" * (("+j+" || "+d+") / 100) + (t = "+m+" ? "+m+" : "+h+') + "px"';if(c[1]){var s=typeof c[1]=="number"?c[1].toString():c[1].replace(/px/,"");q=s.indexOf("%")==-1?s+" + (t = "+l+" ? "+l+" : "+g+') + "px"':parseInt(s.replace(/%/,""))+" * (("+k+" || "+e+") / 100) + (t = "+l+" ? "+l+" : "+g+') + "px"'}}else{o="("+j+" || "+d+") / 2 - (this.offsetHeight / 2) + (t = "+m+" ? "+m+" : "+h+') + "px"';q="("+k+" || "+e+") / 2 - (this.offsetWidth / 2) + (t = "+l+" ? "+l+" : "+g+') + "px"'}n.removeExpression("top");n.removeExpression("left");n.setExpression("top",o);n.setExpression("left",q)}}})},focus:function(b){var c=this,d=b||"first",e=a(":input:enabled:visible:"+d,c.d.wrap);e.length>0?e.focus():c.d.wrap.focus()},getDimensions:function(){var b=a(window),c=a.browser.opera&&a.browser.version>"9.5"&&a.fn.jquery<="1.2.6"?document.documentElement.clientHeight:a.browser.opera&&a.browser.version<"9.5"&&a.fn.jquery>"1.2.6"?window.innerHeight:b.height();return[c,b.width()]},getVal:function(a){return a=="auto"?0:a.indexOf("%")>0?a:parseInt(a.replace(/px/,""))},setContainerDimensions:function(b){var c=this;if(!b||b&&c.o.autoResize){var e=a.browser.opera?c.d.container.height():c.getVal(c.d.container.css("height")),f=a.browser.opera?c.d.container.width():c.getVal(c.d.container.css("width")),g=c.d.data.outerHeight(!0),h=c.d.data.outerWidth(!0),i=c.o.maxHeight&&c.o.maxHeight<d[0]?c.o.maxHeight:d[0],j=c.o.maxWidth&&c.o.maxWidth<d[1]?c.o.maxWidth:d[1];e?e=e>i?i:e:g?g>i?e=i:g<c.o.minHeight?e=c.o.minHeight:e=g:e=c.o.minHeight;f?f=f>j?j:f:h?h>j?f=j:h<c.o.minWidth?f=c.o.minWidth:f=h:f=c.o.minWidth;c.d.container.css({height:e,width:f});(g>e||h>f)&&c.d.wrap.css({overflow:"auto"})}c.o.autoPosition&&c.setPosition()},setPosition:function(){var a=this,b,c,e=d[0]/2-a.d.container.outerHeight(!0)/2,f=d[1]/2-a.d.container.outerWidth(!0)/2;if(a.o.position&&Object.prototype.toString.call(a.o.position)==="[object Array]"){b=a.o.position[0]||e;c=a.o.position[1]||f}else{b=e;c=f}a.d.container.css({left:c,top:b})},watchTab:function(b){var c=this;if(a(b.target).parents(".simplemodal-container").length>0){c.inputs=a(":input:enabled:visible:first, :input:enabled:visible:last",c.d.data[0]);if(!b.shiftKey&&b.target==c.inputs[c.inputs.length-1]||b.shiftKey&&b.target==c.inputs[0]||c.inputs.length==0){b.preventDefault();var d=b.shiftKey?"last":"first";setTimeout(function(){c.focus(d)},10)}}else{b.preventDefault();setTimeout(function(){c.focus()},10)}},open:function(){var b=this;b.d.iframe&&b.d.iframe.show();if(a.isFunction(b.o.onOpen))b.o.onOpen.apply(b,[b.d]);else{b.d.overlay.show();b.d.container.show();b.d.data.show()}b.focus();b.bindEvents()},close:function(){var b=this;if(!b.d.data)return!1;b.unbindEvents();if(a.isFunction(b.o.onClose)&&!b.occb){b.occb=!0;b.o.onClose.apply(b,[b.d])}else{if(b.d.placeholder){var c=a("#simplemodal-placeholder");if(b.o.persist)c.replaceWith(b.d.data.removeClass("simplemodal-data").css("display",b.display));else{b.d.data.hide().remove();c.replaceWith(b.d.orig)}}else b.d.data.hide().remove();b.d.container.hide().remove();b.d.overlay.hide().remove();b.d.iframe&&b.d.iframe.hide().remove();b.d={}}}}})(jQuery);